# SQL, Skriptejä ja Weppiä



## x)

## y)

## a) SQLZoo -tehtäviä

Tehtävänantona käydä läpi tehtävät SQLZoo:n sivuston osista **0 - SELECT basics** ja **2 SELECT from World**. Sivusto on tehty apuvalineeksi SQL -kielen opiskelussa.

Osassa SELECT Basics annettiin taulukko maailman maista, ja niiden erinäisistä statseista (Koko, väkiluku, jne), johon sivun tehtävät perustuivat. Tehtävissä annettiin valmis SQL -koodipätkä, joka hakee sen määrittelemänä tietoa taulukosta, ja tätä koodia piti muokata tehtävänannon mukaisesti. Alla kuvakaappaukset tehtävistä ratkaisun jälkeen, ja pieni selostus SQL:stä.

![image](https://user-images.githubusercontent.com/94109769/200350282-6136010a-6c71-4442-96ee-17bd2a405566.png)

Tämä on SQL:n peruskauraa. SELECT komennolla haetaan tieto taulukosta (tässä tapauksessa "population"), ja samalla rivillä tämän jälkeen FROM määrittelee mistä taulukosta ("world"). WHERE määritelmä tämän järkeen kertoo miten haettua tietoa filtteroidaan. Tässä tapauksessa ``WHERE name = 'x'`` kertoo koodille, että haluamme väkiluvutiedon riviltä, jolla 'name' kentässä on jokin tietty arvo. Alkuperäisessä koodissa tämä tieto oli 'France', mutta muutin siihen 'Germany', jotta saatiin Saksan väliluku.

![image](https://user-images.githubusercontent.com/94109769/200351116-9bae98e4-5d7d-4a5e-b4b5-5f2a89ec76e6.png)

Tällä koodilla poimittiinkin useampi kenttä taulukosta. SELECT lausekkeella voi siis pilkun kanssa lisätä useita haettavia asioita hakuun. Samalla lailla WHERE määritelmän jälkeen ``name IN`` ja sulkujen sisään lisätyt, pilkulla erotetut termit saavat hakemaan useammalla eri hakutermillä. Kaiken tämän tuloksena siis listataan taulukkoon Ruotsin, Norjan ja Tanskan väkiluvut maiden nimien kanssa.

![image](https://user-images.githubusercontent.com/94109769/200361987-fce15521-481c-4d00-a6e2-db5989ec33e3.png)

Tässä tapauksessa WHERE sanan jälkeen käytettiinkin hakutermia, ja sen jälkeen BETWEEN määritelmää, jolla määritellä kaksi eri numeroa joiden väliltä halutusta kentästä haetaan tietoa. Tällä lauseella haettiin siis maat, joiden väkiluku on suurempi kuin 200000, mutta pienempi kuin 250000

Tämän jälkeen siirryin osaan **2 SELECT from World**, jossa vastauksia pitikin jo hakea itsekkin.

![image](https://user-images.githubusercontent.com/94109769/200363080-eafe4ba6-fadf-4bf1-a443-6d44382a6633.png)

Tehtävä 1:ssä tässä osiossa haluttiin siis vaan näyttää, miten tuo koodi ylipäätänsä toimii. Painamalla vaan ajo-nappia päästiin näkemään listaus.

![image](https://user-images.githubusercontent.com/94109769/200363258-6abc7b56-286c-477f-8b6f-b735eff23c01.png)

Tässä tehtävässä esimerkkikoodissa WHERE filtteri olikin kirjoitettu alunperin ``WHERE population = #####``, jolla haettiin maata jonka väkiluku täsmäsi tarkalleen annettua numeroa. Tehtävässä haluttiin tosin listattavan kaikki maat, joissa oli vähintään kaksi miljoonaa asukasta. Tämä toimi muuttamalla yhtäsuuruus merkin toiseksi matemaattiseksi merkiksi >=, joka tarkoittaa siis että tulos on suurempi TAI yhtä suuri kuin annettu määritelmä.

![image](https://user-images.githubusercontent.com/94109769/200364260-0b5c0b4c-d993-4ad1-b2ec-ef70570c4115.png)

Tässä tehtävässä ei ollutkaan valmiiksi yhtään koodia, joten kaikki SQL piti kirjoittaa itse. Hankalammaksi tästä teki myös sen, että tehtävä vaati GDP Per Capita lukua. Onneksi tehtävästä löytyi myös vihje joka kertoi miten se lasketaan. Laskutoimituksen selvityksen jälkeen se piti vain syöttää SELECT lausekkeeseen haettavien kenttien joukkoon; nämäkin siis ottavat vastaan laskutoimituksia, ja koska molemmissa 'population' ja 'gdp' kentissä oli numeroita eikö tekstiä, hakusana ``gdp/population`` kelpasi, ja SQL-koodi automaattisesti käytti kahta termiä muuttujina, jotka korvattiin haettujen numeroidne jakotoimituksen tuloksena.

![image](https://user-images.githubusercontent.com/94109769/200365070-c80d467d-e434-4c6a-8415-32723642f47d.png)

Tässäkään tehtävässä ei ollut yhtään valmiiksi-kirjoitettua koodia, mutta sen vastaus seurasi samoja tekniikoita kuin pari aikaisempaakin.

![image](https://user-images.githubusercontent.com/94109769/200365559-bdd1d623-9f83-4d1e-a9d5-6ec7b98188c5.png)

Tässäkään tehtävässä ei valmista koodia. Tässä vaiheessa tämän koodin kirjoittaminen tosin tuli jo oikeastaan automaattisesti.

Tästä osiosta pyydettiin tekemään vain tehtävät 1-5, joten jätin SQLZoo:ssa seikkailun tähän.

## b) DVWA: Paikallinen tunnus

## c) DVWA: Command Execution

DVWA:n sisällä oli Command Execution osio, jota olisi tarkoitus mennä kokeilemaan sen jälkeen, kun Security Level oli asennettu low:ksi.

![image](https://user-images.githubusercontent.com/94109769/200434276-58bb0493-5639-4277-a5d9-054c4b79aa31.png)

Syöttämällä ihan puhtaasti localhost-osoitteen kenttään, sain seuraavan tuloksen:

![image](https://user-images.githubusercontent.com/94109769/200434354-84c288b4-d9fc-4ba6-8c00-44586524a3b5.png)

Tunnistin tulosteen saman tien. Ohjelma ilmeisesti ajoi PING komennon annetulle osoitteella Metasploitable-koneella, ja lähetti takaisen siitä tulleen tulosteen. Eli toisin sanoen, tällä ohjelmalla pääsen teoriassa ajamaan suoraan komentoja kohdekoneen komentorivillä. View Help napista sain myös nopeasti muistutettua itseäni, että komentoja voi linuxilla ajaa peräkkäin yhdellä syötöllä jakamalla niitä ; -merkillä. Kokeilin uteliaisuudesta siis lisätä syötteeseen whoami komennon (``127.0.0.1;whoami``):

![image](https://user-images.githubusercontent.com/94109769/200434855-21c56e3b-2944-4527-a313-f52176a22246.png)

Tästä selvisi että ohjelma ajaa komentoja www-data -käyttäjän alla. Harmi sinänsä, koska tällä todennäköisesti on aika rajatut oikeudet. Tällä tavalla kuitenkin saa jo hyvin tietoja kerättyä, esimerkiksi tarkistaa passwd -tiedoston sisällön palvelimella olevien käyttäjien listaamiseksi. Metasploitin kaltaisella koneella saisi varmasti privilige escalationiakin tehtyä tämän ja netcat yhteyden kautta, mutta en nyt paneutunut siihen.



