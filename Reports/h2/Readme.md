# Metasploitable 2 harjotusta

Viikon 2 aiheena tunkattiin alustavia harjoitusympäristöjä kasaan, hyödyntäen Virtualboxia ja Metasploitable 2:sta.

## A) Metasploitable 2 asennus

## B) Porttiskannausta

Haetaan ihan ensimmäisenä vähän tietoja tunkeutumiskohteestamme.

Kali Linuxin mukana tulee useimmiten Metasploit -ohjelma, jota hyödynnämme tässä. Komennolla ``msfdb run`` käynnistämme tietokantaan yhdistetyn ohjelman, jolla voimme kerätä helposti tietoa verkkoympäristöstä jossa olemme, ja jopa yksittäisistä koneista.

![image](https://user-images.githubusercontent.com/94109769/199807742-61d92b4f-81c5-43ac-9676-375c3093144e.png)

Luodaan ensin workspace tänne komennolla ``workspace -a metasploitable``, johon tallennamme tietoja. Komennolla voisi vastaavasti parametrin -a sijaan käyttää parametria -d, jolla workspacen voi poistaa, ja ilman parametreja komento ``workspace metasploitable`` suoraan tekee tästä uudesta workspacest aktiivisen.

Tämän jälkeen ajettiin komento ``db_nmap -sV -A <ip osoite/maski> -oA <tiedostonimi>``. Kuten Tero kertoi tunnilla, komento on käytännössä sama kuin suoraan komentoriviltä puhtaasti ajettu nmap, mutta se kerää sen kautta tietoja suoraan tänne metasploit-tietokantaan. -oA parametri tuossa ohjaa tallentamaan skannauksen tulokset ulkoiseen tiedostoon, jonka tiedostonimi tässä myös määritellään. Tiedostot tallennetaan kansioon, joka oli aktiivisena metasploit konsolin avaamisen yhteydessä. Tämä printtaa hirveän paljon kaikkea tietoa, mutta tietoa voi onneksi jälkeenpäin käsitellä hieman kohdennetummin. Esimerkiksi ``hosts`` komennolla, joka listaa kaikki verkossa olevat laitteet, jotka skannaus nappasi.

![image](https://user-images.githubusercontent.com/94109769/199809677-b8fdd692-f3a4-4d5f-b961-a0034194e940.png)

Kolmas rivi, jossa mac-osoitekkin on jäänyt tyhjäksi, on tämä Kali-kone josta skannaus suoritettiin, eli me itse. .1 osoite on tyypillisesti GW. En ole täysin varma mikä tuo .2 osoite on; mahdollisesti inet-verkkokortin osoite, josta nyt on siis virtuaalinen kaapeli pois irti? .4 osoite taas on Metasploitable 2 kone, ja skannaus osaakin kertoa että siellä pyörii jonkin sortin Linuxi, mikä käyttöliittymän versio on, ja suurinpiirteinen arvio koneen käyttötarkoituksesta.

Seuraava hyödyllinen komento on ``services``, joka listaa kaikki aukinaiset portit, jotka skannaus nappasi. Metasploit osaa myös kertoa valmiiksi monesta tunnetusta portista, mitä sillä todennäköisimmin on käytössä. Komennolle voi määritellä tietyn kohteen, jolta näyttää avonaiset portit-- käytetään sitä tässä tapauksessa tuon .4 koneen porttien tutkimiseen.

![image](https://user-images.githubusercontent.com/94109769/199813875-b277743d-821b-452c-b8be-57d388579687.png)

No täällähän oli hirveä määrä aukinaisia portteja. Tulkataan vähän tarkemmin muutamaa porttia tuolta...

``Port 23, telnet -- Linux telnetd``. Tämä on aukinainen portti telnet-yhteyksille, ja jokainen joka on vähänkään kiinnittänyt huomiota verkkoliikenteiden opinnoilla tietää, että telnet-yhteydet ovat järjettömän turvattomia, eikä niissä ole pahemmin salauksia. Teoriassa jos joku kirjaituisi palvelimelle sisään tällä yhteydellä, päästäisiin mahdollisesti kaappaamaan tunnustietoja salaamattomana.

``Port 3306/2534, mysql/postgresql``. Koneella pyörii selvästä SQL tietokantapalvelinohjelmistoa, jota jaetaan verkon kautta käyttöön.

``Port 6667, irc, UnrealIRCd``. Olen itse sen verran vanha, että tunnistin tämän termin heti. IRC oli ennen kaikkea discordeja ja muita ihmeellisiä instant messaging -ohjelmistoja oikein suosittu viestittelyprotokolla. Kone selvästi ajaa omaa IRC-palvelintaan tässä. En voi väittää että teininä olisin itse kauheasti tutustunut tämän tekniikan toimintaan, mutta näppituntumalta tulee vähän arvaus, että tätä kautta voisi löytyä jotain tunkeutumisessa hyväksikäytettävää.

Koneelta löytyy myös ftp-palvelinta, sekä verkkosivupalvelinta (Apache). Jos Apache ajaa pelkästään http:nä eikä https:nä sisällään olevia sivuja (johon tämä tuloste tuntuisi viittaavankin), voi niitä selavaa liikennettäkin tutkia jollain keinolla.
